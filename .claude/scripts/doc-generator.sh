#!/bin/bash

# ë¬¸ì„œ ìë™ ìƒì„± í…œí”Œë¦¿ ìŠ¤í¬ë¦½íŠ¸
# ì‚¬ìš©ë²•: ./doc-generator.sh <AGENT> <FEATURE_NAME>
# ì˜ˆì‹œ: ./doc-generator.sh 1 recurring-events
# ì˜ˆì‹œ: ./doc-generator.sh 2 time-validation

set -e

AGENT=$1
FEATURE_NAME=$2
TIMESTAMP=$(date +%Y%m%d_%H%M%S)

if [ -z "$AGENT" ] || [ -z "$FEATURE_NAME" ]; then
  echo "âŒ ì‚¬ìš©ë²•: ./doc-generator.sh <AGENT> <FEATURE_NAME>"
  echo "AGENT: 1-6"
  echo "ì˜ˆì‹œ: ./doc-generator.sh 1 recurring-events"
  exit 1
fi

# Agent ë²ˆí˜¸ ê²€ì¦
if ! [[ "$AGENT" =~ ^[1-6]$ ]]; then
  echo "âŒ Agent ë²ˆí˜¸ëŠ” 1-6 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤"
  exit 1
fi

# Agentë³„ ë¬¸ì„œ ë””ë ‰í† ë¦¬
DOC_DIR="claudedocs"
mkdir -p "$DOC_DIR"

# Agentë³„ ë¬¸ì„œ ìƒì„±
case "$AGENT" in
  1)
    DOC_FILE="${DOC_DIR}/01-feature-design-${FEATURE_NAME}.md"
    echo "ğŸ“ Agent 1 ëª…ì„¸ ë¬¸ì„œ ìƒì„±: $DOC_FILE"

    cat > "$DOC_FILE" <<'EOF'
# ê¸°ëŠ¥ ì„¤ê³„ ëª…ì„¸

**Agent**: Agent 1 (Feature Design)
**ê¸°ëŠ¥ëª…**: ${FEATURE_NAME}
**ì‘ì„±ì¼**: ${TIMESTAMP}
**ìƒíƒœ**: ğŸš§ ì‘ì„± ì¤‘

---

## 1. í”„ë¡œì íŠ¸ ë¶„ì„

### 1.1 ê¸°ì¡´ ì½”ë“œë² ì´ìŠ¤ í˜„í™©
- [ ] specs/ ë””ë ‰í† ë¦¬ êµ¬ì¡° íŒŒì•…
- [ ] ê´€ë ¨ ê¸°ì¡´ ëª…ì„¸ í™•ì¸
- [ ] ì˜ì¡´ì„± ë¶„ì„

### 1.2 ì‘ì—… ë²”ìœ„ ì •ì˜
**âš ï¸ ì¤‘ìš”**: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ê°€ ì•„ë‹Œ, ëª…ì„¸ êµ¬ì²´í™” ìˆ˜ì¤€ìœ¼ë¡œ ì§„í–‰

**ë²”ìœ„ ë‚´**:
-

**ë²”ìœ„ ì™¸**:
-

---

## 2. ìš”êµ¬ì‚¬í•­ ë¶„ì„

### 2.1 ê¸°ëŠ¥ ê°œìš”


### 2.2 ì£¼ìš” ìš”êµ¬ì‚¬í•­
1.
2.
3.

### 2.3 ì œì•½ì‚¬í•­
-

---

## 3. Given-When-Then ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: [ì‹œë‚˜ë¦¬ì˜¤ ì´ë¦„]

**Given** (ì´ˆê¸° ìƒíƒœ):
-

**When** (ì‚¬ìš©ì í–‰ë™):
-

**Then** (ì˜ˆìƒ ê²°ê³¼):
-
- ì˜ˆì‹œ ì…ë ¥: `...`
- ì˜ˆì‹œ ì¶œë ¥: `...`

---

## 4. ëª…ì„¸ í’ˆì§ˆ ìì²´ ê²€ì¦ (v2.8.0)

ê° í•­ëª©ë§ˆë‹¤ **3ë‹¨ê³„ ê·¼ê±°**ë¥¼ ì„œìˆ í•˜ì„¸ìš”:

### 1. âœ… íŒ¨í„´ ì¤€ìˆ˜
- [ ] Given-When-Then íŒ¨í„´ì„ ëª¨ë“  ì‹œë‚˜ë¦¬ì˜¤ì— ì¼ê´€ë˜ê²Œ ì ìš©í–ˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 2. âœ… êµ¬ì²´ì  ì˜ˆì‹œ
- [ ] êµ¬ì²´ì  ì…ë ¥ê°’ê³¼ ì˜ˆì‹œ ê²°ê³¼ê°’ì„ í•¨ê»˜ ì œê³µí–ˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 3. âœ… ì—£ì§€ ì¼€ì´ìŠ¤
- [ ] ì—£ì§€ ì¼€ì´ìŠ¤ì™€ ì˜ˆì™¸ ìƒí™©ì„ ëª…ì‹œí–ˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 4. âœ… í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±
- [ ] Agent 2ê°€ ì¦‰ì‹œ í…ŒìŠ¤íŠ¸ ì„¤ê³„ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì˜ ìƒì„¸ë„ì¸ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 5. âœ… ëª…ì„¸ ë²”ìœ„ ì¤€ìˆ˜
- [ ] ëª…ì„¸ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šì•˜ëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 6. âœ… êµ¬í˜„ ê°€ëŠ¥ì„±
- [ ] ê¸°ìˆ ì ìœ¼ë¡œ êµ¬í˜„ ê°€ëŠ¥í•œê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 7. âœ… ì˜ˆì‹œ ì¶©ë¶„ì„±
- [ ] ê° ì‹œë‚˜ë¦¬ì˜¤ì— ì¶©ë¶„í•œ ì˜ˆì‹œê°€ ìˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 8. âœ… ìˆ˜ìš© ê¸°ì¤€
- [ ] ëª…í™•í•œ ìˆ˜ìš© ê¸°ì¤€ì´ ìˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

---

## 5. ë‹¤ìŒ ë‹¨ê³„

- [ ] specs/${FEATURE_NAME}.md íŒŒì¼ ìƒì„±
- [ ] Git ì»¤ë°‹ (docs: ${FEATURE_NAME} ëª…ì„¸ ì‘ì„±)
- [ ] Agent 2ì—ê²Œ ì¸ê³„
EOF

    # ë³€ìˆ˜ ì¹˜í™˜
    sed -i.bak "s/\${FEATURE_NAME}/${FEATURE_NAME}/g" "$DOC_FILE"
    sed -i.bak "s/\${TIMESTAMP}/$(date '+%Y-%m-%d %H:%M:%S')/g" "$DOC_FILE"
    rm "${DOC_FILE}.bak"

    echo "âœ… Agent 1 ë¬¸ì„œ ìƒì„± ì™„ë£Œ"
    ;;

  2)
    DOC_FILE="${DOC_DIR}/02-test-design-${FEATURE_NAME}.md"
    echo "ğŸ“ Agent 2 í…ŒìŠ¤íŠ¸ ì„¤ê³„ ë¬¸ì„œ ìƒì„±: $DOC_FILE"

    cat > "$DOC_FILE" <<'EOF'
# í…ŒìŠ¤íŠ¸ ì„¤ê³„ ëª…ì„¸

**Agent**: Agent 2 (Test Design)
**ê¸°ëŠ¥ëª…**: ${FEATURE_NAME}
**ì‘ì„±ì¼**: ${TIMESTAMP}
**ìƒíƒœ**: ğŸš§ ì‘ì„± ì¤‘

---

## 1. ëª…ì„¸ í’ˆì§ˆ ê²€ì¦ (v2.8.0)

**ì°¸ì¡°**: specs/${FEATURE_NAME}.md

ê° í•­ëª©ë§ˆë‹¤ **3ë‹¨ê³„ ê·¼ê±°**ë¥¼ ì„œìˆ í•˜ì„¸ìš”:

### 1. âœ… íŒ¨í„´ ì¤€ìˆ˜
- [ ] Given-When-Then íŒ¨í„´ì´ ì¼ê´€ë˜ê²Œ ì ìš©ë˜ì—ˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 2. âœ… êµ¬ì²´ì  ì˜ˆì‹œ
- [ ] êµ¬ì²´ì  ì˜ˆì‹œê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 3. âœ… ì—£ì§€ ì¼€ì´ìŠ¤
- [ ] ì—£ì§€ ì¼€ì´ìŠ¤ê°€ ëª…ì‹œë˜ì–´ ìˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 4. âœ… í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ ì—¬ë¶€
- [ ] ì¦‰ì‹œ í…ŒìŠ¤íŠ¸ ì‘ì„± ê°€ëŠ¥í•œê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

### 5. âœ… ëª…ì„¸ ë²”ìœ„ ì¤€ìˆ˜
- [ ] ëª…ì„¸ ë²”ìœ„ë¥¼ ì¤€ìˆ˜í–ˆëŠ”ê°€?
  - ê·¼ê±° (ì‚¬ì‹¤):
  - ê·¼ê±° (í‰ê°€):
  - ê·¼ê±° (ëŒ€ì•ˆ):

**ê²€ì¦ ê²°ê³¼**:
- [ ] ëª¨ë“  í•­ëª© í†µê³¼ â†’ Agent 3 ì§„í–‰
- [ ] ë¶ˆì™„ì „ â†’ Agent 1ì—ê²Œ í”¼ë“œë°± (êµ¬ì²´ì  ê°œì„  ìš”ì²­)

---

## 2. í…ŒìŠ¤íŠ¸ êµ¬ì¡° ì„¤ê³„

### 2.1 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
**íŒŒì¼**: `src/__tests__/unit/easy.${FEATURE_NAME}.spec.ts`

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**:
1.
2.
3.

### 2.2 í›… í…ŒìŠ¤íŠ¸ (í•„ìš” ì‹œ)
**íŒŒì¼**: `src/__tests__/hooks/use${FEATURE_NAME}.spec.ts`

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤**:
1.
2.

### 2.3 í†µí•© í…ŒìŠ¤íŠ¸ (í•„ìš” ì‹œ)
**íŒŒì¼**: `src/__tests__/integration/${FEATURE_NAME}.integration.spec.tsx`

**ì‹œë‚˜ë¦¬ì˜¤**:
1.
2.

---

## 3. í…ŒìŠ¤íŠ¸ ë°ì´í„° ì„¤ê³„

### 3.1 Mock ë°ì´í„°
**íŒŒì¼**: `src/__tests__/__fixtures__/mock${FEATURE_NAME}.ts`

```typescript
// ì˜ˆì‹œ
export const mockData = {
  // ...
};
```

### 3.2 í…ŒìŠ¤íŠ¸ í—¬í¼ í•¨ìˆ˜


---

## 4. ë‹¤ìŒ ë‹¨ê³„

- [ ] í…ŒìŠ¤íŠ¸ êµ¬ì¡° ì„¤ê³„ ë¬¸ì„œ ì™„ì„±
- [ ] Fixtures íŒŒì¼ ìƒì„±
- [ ] Git ì»¤ë°‹ (test: [DESIGN] ${FEATURE_NAME} í…ŒìŠ¤íŠ¸ êµ¬ì¡° ì„¤ê³„)
- [ ] Agent 3ì—ê²Œ ì¸ê³„
EOF

    # ë³€ìˆ˜ ì¹˜í™˜
    sed -i.bak "s/\${FEATURE_NAME}/${FEATURE_NAME}/g" "$DOC_FILE"
    sed -i.bak "s/\${TIMESTAMP}/$(date '+%Y-%m-%d %H:%M:%S')/g" "$DOC_FILE"
    rm "${DOC_FILE}.bak"

    echo "âœ… Agent 2 ë¬¸ì„œ ìƒì„± ì™„ë£Œ"
    ;;

  3|4|5)
    if [ "$AGENT" = "3" ]; then
      PHASE="RED"
      AGENT_NAME="Red Phase"
    elif [ "$AGENT" = "4" ]; then
      PHASE="GREEN"
      AGENT_NAME="Green Phase"
    else
      PHASE="REFACTOR"
      AGENT_NAME="Refactor"
    fi

    DOC_FILE="${DOC_DIR}/0${AGENT}-${PHASE,,}-${FEATURE_NAME}.md"
    echo "ğŸ“ Agent $AGENT ($AGENT_NAME) ë¬¸ì„œ ìƒì„±: $DOC_FILE"

    cat > "$DOC_FILE" <<EOF
# ${AGENT_NAME} ë‹¨ê³„

**Agent**: Agent $AGENT (${AGENT_NAME})
**ê¸°ëŠ¥ëª…**: ${FEATURE_NAME}
**ì‘ì„±ì¼**: $(date '+%Y-%m-%d %H:%M:%S')
**ìƒíƒœ**: ğŸš§ ì‘ì—… ì¤‘

---

## 1. ì°¸ì¡° ë¬¸ì„œ

- ëª…ì„¸: specs/${FEATURE_NAME}.md
- í…ŒìŠ¤íŠ¸ ì„¤ê³„: claudedocs/02-test-design-${FEATURE_NAME}.md

---

## 2. ì‘ì—… ë‚´ì—­

### 2.1 íŒŒì¼ ìˆ˜ì •/ìƒì„±


### 2.2 í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ê²°ê³¼

\`\`\`bash
# ì‹¤í–‰ ëª…ë ¹
pnpm test

# ê²°ê³¼
\`\`\`

---

## 3. ë‹¤ìŒ ë‹¨ê³„

- [ ] Git ì»¤ë°‹
- [ ] ë‹¤ìŒ Agentì—ê²Œ ì¸ê³„
EOF

    echo "âœ… Agent $AGENT ë¬¸ì„œ ìƒì„± ì™„ë£Œ"
    ;;

  6)
    DOC_FILE="${DOC_DIR}/06-orchestrator-progress-${FEATURE_NAME}.md"
    echo "ğŸ“ Agent 6 ì§„í–‰ ìƒí™© ë¬¸ì„œ ìƒì„±: $DOC_FILE"

    cat > "$DOC_FILE" <<'EOF'
# Orchestrator ì§„í–‰ ìƒí™©

**Agent**: Agent 6 (Orchestrator)
**ê¸°ëŠ¥ëª…**: ${FEATURE_NAME}
**ì‘ì„±ì¼**: ${TIMESTAMP}

---

## 1. ì „ì²´ ì§„í–‰ ìƒí™©

| Agent | ìƒíƒœ | ì»¤ë°‹ í•´ì‹œ | ë¹„ê³  |
|-------|------|-----------|------|
| Agent 1 | â³ | - | ëª…ì„¸ ì‘ì„± |
| Agent 2 | â³ | - | í…ŒìŠ¤íŠ¸ ì„¤ê³„ |
| Agent 3 | â³ | - | Red Phase |
| Agent 4 | â³ | - | Green Phase |
| Agent 5 | â³ | - | Refactor |
| Agent 6 | ğŸ”„ | - | í’ˆì§ˆ ê²€ì¦ |

---

## 2. í’ˆì§ˆ ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ëª¨ë“  Agentê°€ Git ì»¤ë°‹ ìˆ˜í–‰
- [ ] í…ŒìŠ¤íŠ¸ í†µê³¼ í™•ì¸
- [ ] ë¦°íŠ¸ ê²€ì¦ í†µê³¼
- [ ] TDD ì‚¬ì´í´ ì¤€ìˆ˜
- [ ] ë¬¸ì„œ ì—…ë°ì´íŠ¸ ì™„ë£Œ

---

## 3. ë°œê²¬ëœ ì´ìŠˆ


---

## 4. ìµœì¢… ìƒíƒœ

**ì¢…ë£Œ ì‹œê°**:
**ê²°ê³¼**:
EOF

    # ë³€ìˆ˜ ì¹˜í™˜
    sed -i.bak "s/\${FEATURE_NAME}/${FEATURE_NAME}/g" "$DOC_FILE"
    sed -i.bak "s/\${TIMESTAMP}/$(date '+%Y-%m-%d %H:%M:%S')/g" "$DOC_FILE"
    rm "${DOC_FILE}.bak"

    echo "âœ… Agent 6 ë¬¸ì„œ ìƒì„± ì™„ë£Œ"
    ;;
esac

echo ""
echo "ğŸ“„ ìƒì„±ëœ ë¬¸ì„œ: $DOC_FILE"
echo ""
echo "ë‹¤ìŒ ë‹¨ê³„:"
echo "1. ë¬¸ì„œ ë‚´ìš© ì‘ì„±"
echo "2. Agent ì‘ì—… ìˆ˜í–‰"
echo "3. Git ì»¤ë°‹"
